<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Payslip PDF Generator</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        background-color: #f8f9fa;
        padding: 20px;
        color: #333;
      }

      .container {
        max-width: 1000px;
        margin: 0 auto;
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      /* Header Section */
      .header {
        background: white;
        padding: 24px 32px;
        border-bottom: 1px solid #e5e5e5;
      }

      .nav-tabs {
        display: flex;
        gap: 32px;
        margin-bottom: 24px;
      }

      .nav-tab {
        font-size: 16px;
        font-weight: 500;
        color: #6b7280;
        cursor: pointer;
        padding-bottom: 8px;
        border-bottom: 2px solid transparent;
      }

      .nav-tab.active {
        color: #2563eb;
        border-bottom-color: #2563eb;
      }

      .header-controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .month-selector {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
        color: #374151;
      }

      .month-dropdown {
        background: none;
        border: none;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
      }

      .header-actions {
        display: flex;
        gap: 16px;
      }

      .btn-link {
        display: flex;
        align-items: center;
        gap: 6px;
        color: #2563eb;
        text-decoration: none;
        font-size: 14px;
        font-weight: 500;
      }

      /* Summary Section */
      .summary-section {
        padding: 32px;
        display: flex;
        gap: 48px;
        align-items: center;
      }

      .chart-container {
        position: relative;
      }

      .donut-chart {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        background: conic-gradient(#ef4444 0deg 144deg, #10b981 144deg 360deg);
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
      }

      .donut-chart::before {
        content: "";
        width: 70px;
        height: 70px;
        background: white;
        border-radius: 50%;
        position: absolute;
      }

      .chart-label {
        position: absolute;
        z-index: 2;
        text-align: center;
        font-weight: 600;
        color: #374151;
      }

      .chart-month {
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .chart-year {
        font-size: 16px;
        margin-top: 2px;
      }

      .summary-details {
        flex: 1;
      }

      .take-home {
        margin-bottom: 24px;
      }

      .take-home-label {
        font-size: 14px;
        color: #6b7280;
        margin-bottom: 4px;
      }

      .take-home-amount {
        font-size: 32px;
        font-weight: 700;
        color: #111827;
      }

      .breakdown {
        display: flex;
        gap: 48px;
      }

      .breakdown-item {
        display: flex;
        flex-direction: column;
      }

      .breakdown-label {
        font-size: 12px;
        color: #6b7280;
        margin-bottom: 4px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .breakdown-amount {
        font-size: 18px;
        font-weight: 600;
      }

      .deductions {
        color: #ef4444;
      }

      .gross-pay {
        color: #374151;
      }

      /* Company Info */
      .company-info {
        padding: 0 32px 24px;
        border-bottom: 1px solid #e5e5e5;
      }

      .company-name {
        font-size: 20px;
        font-weight: 700;
        color: #111827;
        margin-bottom: 4px;
      }

      .company-address {
        font-size: 14px;
        color: #6b7280;
      }

      /* Payslip Details */
      .payslip-details {
        padding: 32px;
      }

      .payslip-title {
        font-size: 18px;
        font-weight: 700;
        color: #111827;
        margin-bottom: 24px;
      }

      .employee-summary {
        background: #f9fafb;
        border-radius: 8px;
        /* padding: 20px; */
        margin-bottom: 32px;
      }

      .section-title {
        font-size: 16px;
        font-weight: 600;
        color: #111827;
        margin-bottom: 16px;
      }

      .employee-info-grid {
        display: flex;
        align-items: center;
        gap: 120px;
      }

      .employee-left-column {
        display: flex;
        flex-direction: column;
        gap: 16px;
      }

      /* emd */

      .employee-right-column {
        display: flex;
        justify-content: center;
        align-items: flex-start;
      }
      .info-row {
        display: grid;
        grid-template-columns: 160px 1fr; /* Fixed width for labels */
        gap: 20px;
        align-items: center;
      }

      .info-label {
        font-size: 14px;
        color: #6b7280;
      }

      .info-value {
        font-size: 14px;
        font-weight: 500;
        color: #111827;
      }

      .net-pay-highlight {
        background: #ecfdf5;
        border: 1px solid #d1fae5;
        border-radius: 8px;
        padding: 16px;
        text-align: center;
        width: 220px;
        min-width: 200px;
      }

      .net-pay-label {
        font-size: 14px;
        color: #065f46;
        margin-bottom: 4px;
      }

      .net-pay-amount {
        font-size: 28px;
        font-weight: 700;
        color: #047857;
      }

      .pay-details {
        font-size: 12px;
        color: #6b7280;
        margin-top: 8px;
      }

      /* Earnings and Deductions Table */
      .earnings-deductions {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 32px;
        margin-bottom: 32px;
      }

      .table-container {
        background: #f9fafb;
        border-radius: 8px;
        overflow: hidden;
      }

      .table-header {
        background: #f3f4f6;
        padding: 12px 16px;
        font-size: 14px;
        font-weight: 600;
        color: #374151;
        border-bottom: 1px solid #e5e7eb;
      }

      .table-content {
        padding: 0;
      }

      .table-row {
        display: grid;
        grid-template-columns: 2fr 1fr 1fr;
        gap: 16px;
        padding: 12px 16px;
        border-bottom: 1px solid #e5e7eb;
      }

      .table-row:last-child {
        border-bottom: none;
      }

      .table-row.total {
        background: #f3f4f6;
        font-weight: 600;
        border-top: 2px solid #d1d5db;
      }

      .table-cell {
        color: #374151;
      }

      .table-cell.amount {
        display: grid;
        grid-template-columns: 1fr 1fr;
        font-weight: 500;
      }

      /* Final Total */
      .final-total {
        background: #f0f9ff;
        border: 2px solid #0ea5e9;
        border-radius: 8px;
        padding: 20px;
        text-align: center;
      }

      .final-total-text {
        font-size: 18px;
        font-weight: 700;
        color: #0c4a6e;
      }

      .final-amount {
        color: #0369a1;
      }

      .amount-words {
        font-size: 12px;
        color: #64748b;
        margin-top: 4px;
        font-style: italic;
      }

      /* Print Styles */
      @media print {
        body {
          background: white;
          padding: 0;
        }

        .container {
          box-shadow: none;
          border-radius: 0;
          max-width: none;
        }

        .header-actions {
          display: none;
        }
      }

      /* Responsive */
      @media (max-width: 768px) {
        .summary-section {
          flex-direction: column;
          text-align: center;
          gap: 24px;
        }

        .breakdown {
          justify-content: center;
        }

        .earnings-deductions {
          grid-template-columns: 1fr;
          gap: 24px;
        }

        .employee-info-grid {
          grid-template-columns: 1fr;
          gap: 16px;
        }

        .net-pay-highlight {
          width: 100%;
          min-width: auto;
        }
      }
    </style>
  </head>
  <body>
    <div class="container" id="payslip-container">
      <!-- Summary Section -->
      <div class="summary-section">
        <div class="chart-container">
          <div class="donut-chart">
            <div class="chart-label">
              <div class="chart-month"><%= month_name %></div>
              <div class="chart-year"><%= year %></div>
            </div>
          </div>
        </div>
        <div class="summary-details">
          <div class="take-home">
            <div class="take-home-amount" id="take-home-amount">
              <%= salary.net_salary %>
            </div>
          </div>

          <div class="breakdown">
            <div class="breakdown-item">
              <div class="breakdown-label deductions">Deductions</div>
              <div class="breakdown-amount deductions" id="deductions-amount">
                <%= salary?.deduction %>
              </div>
            </div>
            <div class="breakdown-item">
              <div class="breakdown-label gross-pay">Gross Pay</div>
              <div class="breakdown-amount gross-pay" id="gross-pay-amount">
                <%= salary?.salary %>
              </div>
            </div>
          </div>
        </div>
        <div class="logo-container">
          <img
            src="data:image/png;base64,<%= logo %>"
            alt="Logo"
            class="logo"
          />
        </div>
      </div>

      <!-- Company Info -->
      <div class="company-info">
        <div class="company-name" id="company-name">
          <%= company.company_name %>
        </div>
        <div class="company-address" id="company-address">
          <%= company.address %>
        </div>
      </div>

      <!-- Payslip Details -->
      <div class="payslip-details">
        <div class="payslip-title" id="payslip-title">
          Payslip for the month of <%= pay_period %>
        </div>

        <div class="employee-summary">
          <div class="section-title">Employee Pay Summary</div>
          <div class="employee-info-grid">
            <div>
              <div class="employee-left-column">
                <div class="info-row">
                  <span class="info-label">Employee Name</span>
                  <span class="info-value" id="employee-name">
                    <%= employee?.first_name %> <%= employee?.last_name %></span
                  >
                </div>
                <div class="info-row">
                  <span class="info-label">Designation</span>
                  <span class="info-value" id="designation">
                    <%= employee?.designation?.title %></span
                  >
                </div>
                <div class="info-row">
                  <span class="info-label">Pay Period</span>
                  <span class="info-value" id="pay-period">
                    <%= pay_period %></span
                  >
                </div>
                <div class="info-row">
                  <span class="info-label">PF A/C Number</span>
                  <span class="info-value" id="pf-number">
                    <%= employee?.EmployeePersonalInformation?.epf_no %></span
                  >
                </div>
                <div class="info-row">
                  <span class="info-label">Employee Net Pay</span>
                  <span class="info-value" id="employee-net-pay-label"
                    ><%= salary?.net_salary %></span
                  >
                </div>
                <div class="info-row">
                  <span class="info-label">Date of Joining</span>
                  <span class="info-value" id="joining-date">
                    <%= new Date(employee?.date_of_joining).toLocaleDateString()
                    %></span
                  >
                </div>
                <div class="info-row">
                  <span class="info-label">Pay Date</span>
                  <span class="info-value" id="pay-date"> <%= pay_date %></span>
                </div>
                <div class="info-row">
                  <span class="info-label">ESI Number</span>
                  <span class="info-value" id="esi-number">
                    <%= employee?.EmployeePersonalInformation?.esic_no %></span
                  >
                </div>
              </div>
            </div>

            <div class="employee-right-column">
              <div class="net-pay-highlight">
                <div class="net-pay-label">Employee Net Pay</div>
                <div class="net-pay-amount" id="net-pay-amount">
                  <%= salary?.net_salary %>
                </div>
                <div class="pay-details" id="pay-details">
                  Paid Days : <%= month_days %> | LOP Days : <%= total_leave %>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Earnings and Deductions -->
        <div class="earnings-deductions">
          <div class="table-container">
            <div class="table-content">
              <div class="table-header table-row">
                <div class="table-cell" style="font-weight: 600">Earnings</div>
                <div class="table-cell amount" style="font-weight: 600">
                  Amount
                </div>
                <div class="table-cell amount" style="font-weight: 600">
                  YTD
                </div>
              </div>

              <div class="table-row">
                <div class="table-cell">Basic</div>
                <div class="table-cell amount"><%= salary?.base_salary %></div>
                <div class="table-cell amount"><%= basicYTD %></div>
              </div>
              <!-- <div class="table-row">
                <div class="table-cell">Basic Arrear</div>
                <div class="table-cell amount">₹15,210.00</div>
                <div class="table-cell amount">₹1,86,810.00</div>
              </div> -->
              <div class="table-row">
                <div class="table-cell">House Rent Allowance</div>
                <div class="table-cell amount">
                  <%= employee?.employee_salary?.hra %>
                </div>
                <div class="table-cell amount"><%= hraYTD %></div>
              </div>
              <!-- <div class="table-row">
                <div class="table-cell">House Rent Allowance Arrear</div>
                <div class="table-cell amount">₹7,606.00</div>
                <div class="table-cell amount">₹93,406.00</div>
              </div> -->
              <!-- <div class="table-row">
                <div class="table-cell">Conveyance Allowance</div>
                <div class="table-cell amount">₹500.00</div>
                <div class="table-cell amount">₹2,000.00</div>
              </div> -->
              <!-- <div class="table-row">
                <div class="table-cell">Transport Allowance</div>
                <div class="table-cell amount">₹500.00</div>
                <div class="table-cell amount">₹2,000.00</div>
              </div> -->
              <!-- <div class="table-row">
                <div class="table-cell">Fixed Allowance</div>
                <div class="table-cell amount">₹10,481.00</div>
                <div class="table-cell amount">₹26,366.00</div>
              </div>
              <div class="table-row">
                <div class="table-cell">Fixed Allowance Arrear</div>
                <div class="table-cell amount">₹-10,453.00</div>
                <div class="table-cell amount">₹60,332.00</div>
              </div> -->
              <div class="table-row total">
                <div class="table-cell">Gross Earnings</div>
                <div class="table-cell amount" id="gross-earnings">
                  <%=salary?.salary %>
                </div>
                <div class="table-cell amount"></div>
              </div>
            </div>
          </div>

          <div class="table-container">
            <div class="table-content">
              <div class="table-header table-row">
                <div class="table-cell" style="font-weight: 600">
                  Deductions
                </div>
                <div class="table-cell amount" style="font-weight: 600">
                  Amount
                </div>
                <div class="table-cell amount" style="font-weight: 600">
                  YTD
                </div>
              </div>
              <div class="table-row">
                <div class="table-cell">EPF Contribution</div>
                <div class="table-cell amount"><%= total_epf %></div>
                <div class="table-cell amount"><%= epfYTD %></div>
              </div>
              <!-- <div class="table-row">
                <div class="table-cell">Employee State Insurance</div>
                <div class="table-cell amount">₹454.00</div>
                <div class="table-cell amount">₹1,265.00</div>
              </div>
              <div class="table-row">
                <div class="table-cell">Income Tax</div>
                <div class="table-cell amount">₹8,370.00</div>
                <div class="table-cell amount">₹18,458.00</div>
              </div> -->
              <div class="table-row total">
                <div class="table-cell">Total Deductions</div>
                <div class="table-cell amount" id="total-deductions">
                  <%= total_epf %>
                </div>
                <div class="table-cell amount"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Final Total -->
        <div class="final-total">
          <div class="final-total-text">
            Total Net Payable
            <span class="final-amount" id="final-net-pay">
              <%= salary?.net_salary %></span
            >
            <div class="amount-words"><%= amount_in_inr %></div>
          </div>
        </div>
      </div>
      <div style="text-align: center">
        <p>
          ********** THIS IS A COMPUTER GENERATED PAYSLIP, NOT REQUIRING
          SIGNATURE **********
        </p>
      </div>
    </div>
  </body>
</html>
